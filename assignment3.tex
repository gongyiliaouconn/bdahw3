%%
%% assignment3.tex
%% 
%% Made by GONG-YI LIAO
%% Login   <gong-yi@GongTop>
%% 
%% Started on  Sat Nov  6 17:57:05 2010 GONG-YI LIAO
%% Last update Tue Nov  9 22:24:15 2010 GONG-YI LIAO
%%

\documentclass[twoside,12pt]{amsart}

\usepackage{bm,amssymb,amsmath}
\usepackage{mathrsfs}
\usepackage{graphicx}

\setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{0pt}
\setlength{\textwidth}{6.5in}
\setlength{\textheight}{9.0in}
\setlength{\topmargin}{-0.5in}
\setlength{\headheight}{15pt}
\setlength{\headsep}{15pt}
\setlength{\footskip}{25pt}
\setlength{\parindent}{0.25in}
\setlength{\parskip}{0pt} 

\author{Gong-Yi Liao}
\title{Assignment 3}

\begin{document}
\maketitle

\begin{enumerate}
\item
  Consider the model that $(Y_{j1}, Y_{j2}, Y_{j3})'\sim\mathcal
  Multinomial(\bm p_j, \sum_{i=1}^3y_{ji})$, $j=1,2$, $\bm p_j = (p_{j1}, p_{j2},
  p_{j3})'$, $\sum_{i=1}^3p_{ji} = 1$. Apparently $\alpha_j =
  \frac{p_{j1}}{p_{j1}+p_{j2}}$, 
  where $p_{j1}$ denotes the probability that people prefer Bush at
  poll time $j$, , $p_{j2}$ denotes the probability that peoples
  prefer Dukakis at time $j$ and $p_{j3}$ denotes the probabiltiy that
  neither candidates are not preferred by the people. 

  We assume that $\bm p$ has a Dirichlet distribution with parameters
  $\bm\xi = (\xi_1, \xi_2, \xi_3)'$, all $\xi$'s are
  all non-negative real numbers.
  Now, with this prior setting, we have the form:
  \[
  \mathscr P(\bm y_j, \bm p|\bm\xi) =
  \frac{\Gamma\left(\sum_{i=1}^3y_{ji}+1\right)\Gamma\left(\sum_{i=1}^3\xi_i\right)}{\prod_{i=1}^3\Gamma(y_{ji}+1)\cdot\Gamma(\xi_i)}\prod_{i=1}^3p_i^{y_{ji} + \xi_i}
  \]
  and thus
  \[
  \mathscr P(\bm y_j|\bm\xi) = 
  \frac{\Gamma\left(\sum_{i=1}^3y_{ji}+1\right)\Gamma\left(\sum_{i=1}^3\xi_i\right)\prod_{i=1}^3\Gamma(y_{ji}+\xi_i)}
  {\prod_{i=1}^3\left[\Gamma(y_{ji}+1)\cdot\Gamma(\xi_i)\right]\Gamma\left(\sum_{i=1}^3y_{ji}+\xi_i\right)}\times
  \]
  \[
  \int_{\bm p\in (0,1)^3, \sum_{i=1}^3 p_i=1}
  \frac{\Gamma\left(\sum_{i=1}^3y_{ji}+\xi_i\right)}{\prod_{i=1}^3\Gamma(y_{ji}+\xi_i)}
  \prod_{i=1}^3p_i^{y_{ji} + \xi_i}d\bm p
  \]
  \[
  =\frac{\Gamma\left(\sum_{i=1}^3y_{ji}+1\right)\Gamma\left(\sum_{i=1}^3\xi_i\right)\prod_{i=1}^3\Gamma(y_{ji}+\xi_i)}
  {\prod_{i=1}^3\left[\Gamma(y_{ji}+1)\cdot\Gamma(\xi_i)\right]\Gamma\left(\sum_{i=1}^3y_{ji}+\xi_i\right)}
  \]
  and so
  \[
  \mathscr P(\bm p|\bm y_j,\bm\xi) =   \frac{\Gamma\left(\sum_{i=1}^3y_{ji}+\xi_i\right)}{\prod_{i=1}^3\Gamma(y_{ji}+\xi_i)}
  \prod_{i=1}^3p_i^{y_{ji} + \xi_i}
  \]
  Now, a problem raise, if we utilize Dirichlet Distribution, what
  value of $\bm\xi$ we should choose? 

  
  
\item
\item
\item
  \begin{enumerate}
  \item The posterior density of $\theta$ is:
    \[ 
y    \mathscr P(\bm y) = 
    \int_{\mathbb R}\prod_{i=1}^n\pi^{-1}[1 +
    (y_i-\theta)^2]^{-1}\pi(\theta)d\theta = \pi^{-n}\int_{\mathbb R}\prod_{i=1}^n[1 +
    (\theta-y_i)^2]^{-1}d\theta 
    \]
    thus,
    \[ 
    \mathscr P(\theta|\bm y) \propto \frac{\prod_{i=1}^n[1 +
    (y_i-\theta)^2]^{-1}}{\int_{\mathbb R}\prod_{i=1}^n[1 +
    (\theta-y_i)^2]^{-1}d\theta}
    \]

    The corresponding {\tt R} code are:

    \begin{small}
    \begin{verbatim}

require(MCMCpack)
require(arm)
require(R2jags)

## Q4

post.inte.two.sample <- function(theta, obs) {
  def1 <- 1
  ## the reason that we need to use the inefficient loop
  ## is that the function integration needs the exact form
  ## of the function, but, if we use "sum" or "prod" then the
  ## exact form of function will be invisible to
  ## the function "integration" and error will occur at the second
  ## stage.
  for (i in 1:length(obs))
    def1 <- def1/(1+(theta - obs[i])^2)
  def1
}

post.two.sample.cauchy <- function(theta, obs) {
  norm.post.0 <- integrate(post.inte.two.sample, lower=-Inf, upper=Inf, 
                           obs=obs)$value
  post.inte.two.sample(theta, obs)/norm.post.0
}

logfun1 <- function(theta, obs) {
  ## usage:
  log(post.two.sample.cauchy(theta, obs))
}

post.mean.fun.1 <- function(theta, obs) {
  theta*post.two.sample.cauchy(theta, obs)
}
      
    \end{verbatim}
    \end{small}
  \item
    \begin{enumerate}
    \item
      \[ 
      \mathscr P\left(\theta|(1.5, 2.5)'\right) \propto \frac{[1 +
        (1.5 - \theta)^2]^{-1}[1 +
        (2.5 - \theta)^2]^{-1}}{\int_{\mathbb R}[1 +
        (\theta - 1.5)^2]^{-1}[1 +
        (\theta - 2.5)^2]^{-1}d\theta}
      \]
      and denominator can be computed numerically. This posterior
      density is shown in Fig.\ref{fig:4-b-i}

      \begin{figure}[h]
        \includegraphics[scale=.5]{4-b-i.pdf}
        \caption{The posterior density of $\theta$ conditional on $\bm
          y = (1.5, 2.5)'$}\label{fig:4-b-i}
      \end{figure}

    \item
      By using {\tt R}'s {\tt MCMCpack}'s {\tt MCMCMetrop1R} function,
      we can obtain the posterior samples of $\theta$:      
      \begin{verbatim}
> ## Metropolis-Hasting sampled Î¸ for y = (1.5, 2.5)
> post.sample.b.ii <- MCMCmetrop1R(logfun1, theta.init=rnorm(1), 
+                                  thin=1, mcmc=40000, burnin=500, 
+                                  obs=c(1.5, 2.5), logfun=TRUE) 

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The Metropolis acceptance rate was 0.72894
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
> 
> mean(post.sample.b.ii)
[1] 2.002400
> var(post.sample.b.ii)
         [,1]
[1,] 1.015655
> mean.nc <- integrate(post.mean.fun.1, lower=-Inf, upper=Inf, 
+                      obs=c(1.5, 2.5))$value
> 
> mean.nc
[1] 2
>         
      \end{verbatim}
      where the MCMC mean is $2.002400$ and numerical mean is $2$.
    \item
    \end{enumerate}
  \item
    \begin{enumerate}
    \item This posterior density is shown in Fig.\ref{fig:4-c-i}
      \begin{figure}[h]
        \includegraphics[scale=.5]{4-c-i.pdf}
        \caption{The posterior density of $\theta$ conditional on $\bm
          y = (-3, -2, 1.5, 2.5)'$}\label{fig:4-c-i}
      \end{figure}
    \item
      We can obtain the MCMC and numerical result by using following
      {\tt R} commands
      \begin{verbatim}
> post.sample.c.ii <- MCMCmetrop1R(logfun1, theta.init=rnorm(1), 
+                                  obs=c(-3, -2, 1.5, 2.5),
+                                  thin=1, mcmc=80000, burnin=500, 
+                                  logfun=TRUE) 

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The Metropolis acceptance rate was 0.80627
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
> > mean(post.sample.c.ii)
[1] -0.2505891
> var(post.sample.c.ii)
         [,1]
[1,] 3.399949
> mean.nc <- integrate(post.mean.fun.1, 
+       lower=-Inf, upper=Inf, obs=c(-3, -2, 1.5, 2.5))$value
> mean.nc
[1] -0.25
>         
    \end{verbatim}
      where the MCMC mean is $-0.2505891$, the numerical mean is $-0.25$.
    \item
    \item
    \end{enumerate}
  \end{enumerate}
\item
\end{enumerate}

\end{document}








